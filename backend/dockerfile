# # FROM golang:1.24.0-alpine AS builder
# # WORKDIR /app

# # COPY go.mod go.sum ./
# # RUN go mod download

# # # Copy your book images into the image
# # COPY ../data/books /app/data/books

# # COPY . .
# # RUN go build -o backendservice .

# # FROM alpine:latest
# # WORKDIR /root/
# # COPY --from=builder /app/backendservice .

# # EXPOSE 8080
# # CMD ["./backendservice"]
# Stage 1
# Stage 1: Builder
# Stage 1: Build Go binary
# Stage 1: Build
# Stage 1: Build
# Stage 1: Build


# Stage 1: Build the Go binary
FROM golang:1.24.0-alpine AS builder
WORKDIR /app

# Copy Go modules (from backend folder)
COPY backend/go.mod backend/go.sum ./
RUN go mod download

# Copy backend source code
COPY backend/ ./

# âœ… Copy books data from root-level "data/books"
COPY data/books /app/data/books

# Build the Go binary
RUN go build -o backendservice

# Stage 2: Final image
FROM alpine:latest
WORKDIR /app
COPY --from=builder /app/backendservice .
COPY --from=builder /app/data/books ./data/books

EXPOSE 8080
CMD ["./backendservice"]
